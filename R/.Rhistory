dir.create(path)
}
}
}
for(year in years) {
for (week in weeks) {
weekFile <- paste(c("..\\Data\\RPlayerNames\\", year, "\\week_", week, ".json"), collapse = "") # File with the information of the week and the comments
gameFile <- paste(c("..\\Data\\Kaggle\\", year, "\\week_", week, ".json"), collapse = "") # File with the detailed information of the player stats in a week
if (file.exists(weekFile)) {
if(file.exists(gameFile)) {
resultWeek <- rjson::fromJSON(file = weekFile)
resultGame <- rjson::fromJSON(file = gameFile)
i <- 1 # For iteration purpose
for (game in resultWeek$games) {
j <- 1 # For iteration purpose
if (length(game$players) < 1) {
resultWeek$games[[i]]$players <- "NoPlayersFound"
} else {
for(playerInGame in game$players) {
for(playerInWeek in resultGame) {
if (playerInGame$player_id == playerInWeek$player_id) {
game$players[[j]] <- list(playerInGame, playerInWeek)
names(game$players[[j]]) <- c("player information", "game information")
j <- j + 1
}
}
}
resultPlayers <- list()
j <- 1 # for iteration purpose
for (player in game$players) { # Remove duplicates (duplicates don't have two sublists)
if (length(player) == 2) {
resultPlayers[[j]] <- player
j <- j + 1
}
}
resultWeek$games[[i]]$players <- resultPlayers
}
i <- i + 1
}
exportJSON <- rjson::toJSON(resultWeek, 1) #Generate JSON
fileName <- paste(c("..\\Data\\RMoreInformation\\", year, "\\week_", week, ".json"), collapse = "")
write(exportJSON, fileName) #Save JSON to file
}
}
}
}
weeks <- list("01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20")
years <- list("2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017")
#Creating the Folders if not exists
path <- "..\\Data\\RMoreInformation"
if (!(dir.exists(path))){
dir.create(path)
}
for (year in years) {
for (week in weeks) {
path <- paste(c("..\\Data\\RMoreInformation\\", year), collapse = "")
if (!(dir.exists(path))){
dir.create(path)
}
}
}
for(year in years) {
for (week in weeks) {
weekFile <- paste(c("..\\Data\\RPlayerNames\\", year, "\\week_", week, ".json"), collapse = "") # File with the information of the week and the comments
gameFile <- paste(c("..\\Data\\Kaggle\\", year, "\\week_", week, ".json"), collapse = "") # File with the detailed information of the player stats in a week
if (file.exists(weekFile)) {
if(file.exists(gameFile)) {
resultWeek <- rjson::fromJSON(file = weekFile)
resultGame <- rjson::fromJSON(file = gameFile)
i <- 1 # For iteration purpose
for (game in resultWeek$games) {
j <- 1 # For iteration purpose
if (length(game$players) < 1) {
resultWeek$games[[i]]$players <- "NoPlayersFound"
} else {
for(playerInGame in game$players) {
for(playerInWeek in resultGame) {
if (playerInGame$player_id == playerInWeek$player_id) {
game$players[[j]] <- list(playerInGame, playerInWeek)
names(game$players[[j]]) <- c("player information", "game information")
j <- j + 1
}
}
}
resultPlayers <- list()
j <- 1 # for iteration purpose
for (player in game$players) { # Remove duplicates (duplicates don't have two sublists)
if (length(player) == 2) {
resultPlayers[[j]] <- player
j <- j + 1
}
}
resultWeek$games[[i]]$players <- resultPlayers
}
i <- i + 1
}
exportJSON <- rjson::toJSON(resultWeek, 1) #Generate JSON
fileName <- paste(c("..\\Data\\RMoreInformation\\", year, "\\week_", week, ".json"), collapse = "")
write(exportJSON, fileName) #Save JSON to file
}
}
}
}
library(rjson)
weeks <- list("01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20")
years <- list("2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017")
#Creating the Folders if not exists
path <- "..\\Data\\RPlayerNames"
if (!(dir.exists(path))){
dir.create(path)
}
for (year in years) {
for (week in weeks) {
path <- paste(c("..\\Data\\RPlayerNames\\", year), collapse = "")
if (!(dir.exists(path))){
dir.create(path)
}
}
}
for (year in years) {
#Read game file
gameFile <- paste(c("..\\Data\\Kaggle\\", year, "Games.json"), collapse = "")
resultGames <- rjson::fromJSON(file= gameFile)
#Read players file
playersFile <- paste(c("..\\Data\\Kaggle\\", year, "Players.json"), collapse = "")
resultPlayers <- rjson::fromJSON(file = playersFile)
for (week in weeks) {
#Name of the file for the matching week
weekFile <- paste(c("..\\Data\\Walterfootball\\", year, "\\week_", week, ".json"), collapse = "")
if (file.exists(weekFile)) {
resultWeek <- rjson::fromJSON(file = weekFile) #Parse json from file
finalJSON <- list() #The output will be stored in this
finalJSON$week <- resultWeek$week
finalJSON$year <- resultWeek$year
finalJSON$numberOfGames <- resultWeek$numberOfGames
i <- 1 #For iteration
while(i <= as.integer(resultWeek$numberOfGames)){
gameName <- paste(c("Game ", i), collapse = "")
game <- get(gameName, resultWeek) #Get game 1, 2, 3...
allComments <- "" #All comments are saved in one var
firstNum <- TRUE #The first element of the game$comments is the number of comments, we don't want in the text
for (comment in game$comments) {
if(firstNum){
firstNum <- FALSE
} else {
allComments <- paste(allComments, comment, setp=" ")
}
}
game$comments <- allComments
playersInGame <- list() #In this list will all players that occur in the comments be saved
j <- 1 #For iteration
for (player in resultPlayers) {
if(length(grep(player$name, allComments) > 0)) { #Checks if playername is in comments
playersInGame[[j]] <- player
j <- j + 1
}
}
game$players <- playersInGame
finalJSON$games[[i]] <- game
i <- i + 1
}
exportJSON <- rjson::toJSON(finalJSON, 1) #Generate JSON
fileName <- paste(c("..\\Data\\RPlayerNames\\" , year, "\\week_",  week, ".json"), collapse = "")
write(exportJSON, fileName) #Save JSON to file
}
}
}
library(rjson)
weeks <- list("01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20")
years <- list("2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017")
#Creating the Folders if not exists
path <- "..\\Data\\RMoreInformation"
if (!(dir.exists(path))){
dir.create(path)
}
for (year in years) {
for (week in weeks) {
path <- paste(c("..\\Data\\RMoreInformation\\", year), collapse = "")
if (!(dir.exists(path))){
dir.create(path)
}
}
}
for(year in years) {
for (week in weeks) {
weekFile <- paste(c("..\\Data\\RPlayerNames\\", year, "\\week_", week, ".json"), collapse = "") # File with the information of the week and the comments
gameFile <- paste(c("..\\Data\\Kaggle\\", year, "\\week_", week, ".json"), collapse = "") # File with the detailed information of the player stats in a week
if (file.exists(weekFile)) {
if(file.exists(gameFile)) {
resultWeek <- rjson::fromJSON(file = weekFile)
resultGame <- rjson::fromJSON(file = gameFile)
i <- 1 # For iteration purpose
for (game in resultWeek$games) {
j <- 1 # For iteration purpose
if (length(game$players) < 1) {
resultWeek$games[[i]]$players <- "NoPlayersFound"
} else {
for(playerInGame in game$players) {
for(playerInWeek in resultGame) {
if (playerInGame$player_id == playerInWeek$player_id) {
game$players[[j]] <- list(playerInGame, playerInWeek)
names(game$players[[j]]) <- c("player information", "game information")
j <- j + 1
}
}
}
resultPlayers <- list()
j <- 1 # for iteration purpose
for (player in game$players) { # Remove duplicates (duplicates don't have two sublists)
if (length(player) == 2) {
resultPlayers[[j]] <- player
j <- j + 1
}
}
resultWeek$games[[i]]$players <- resultPlayers
}
i <- i + 1
}
exportJSON <- rjson::toJSON(resultWeek, 1) #Generate JSON
fileName <- paste(c("..\\Data\\RMoreInformation\\", year, "\\week_", week, ".json"), collapse = "")
write(exportJSON, fileName) #Save JSON to file
}
}
}
}
library(stringr)
library(rjson)
numExtract <- function(string) {
allNumbers <- regmatches(string, gregexpr("[[:digit:]]+", string))
allNumbers <- as.numeric(unlist(allNumbers))
allNumbers <- as.list(strsplit(toString(allNumbers), ", ")[[1]])
return(allNumbers)
}
weeks <- list("01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20")
years <- list("2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017")
#Creating the Folders if not exists
path <- "..\\Data\\Output"
if (!(dir.exists(path))){
dir.create(path)
}
for (year in years) {
for (week in weeks) {
path <- paste(c("..\\Data\\Output\\", year), collapse = "")
if (!(dir.exists(path))){
dir.create(path)
}
}
}
for (year in years) {
for (week in weeks) {
weekFile <- paste(c("..\\Data\\RMoreInformation\\", year, "\\week_", week, ".json"), collapse = "") # File with the information of the week and the comments
if (file.exists(weekFile)) {
resultWeek <- rjson::fromJSON(file = weekFile)
i <- 1
for (game in resultWeek$games) {
numbers <- numExtract(game$comments)
j <- 1
if (game$players != "NoPlayersFound"){
for (player in game$players) {
playerInformation <- player$`game information`
properties <- paste(names(playerInformation), playerInformation)
for (number in numbers) {
for (property in properties) {
propertyName <- strsplit(property, "[[:space:]]")[[1]][1]
propertyValue <- strsplit(property, "[[:space:]]")[[1]][2]
if (number == propertyValue) {
if (number != 0) {
playerInformation[[propertyName]] <- list(propertyValue, 13)
names(playerInformation[[propertyName]]) <- c("propertyValue", "annotationID")
}
}
}
}
resultWeek$games[[i]]$players[[j]]$`game information` <- playerInformation
j <- j + 1
}
}
i <- i + 1
}
exportJSON <- rjson::toJSON(resultWeek, pretty = TRUE) #Generate JSON
fileName <- paste(c("..\\Data\\Output\\", year, "\\week_", week, ".json"), collapse = "")
write(exportJSON, fileName) #Save JSON to file
#jsonlite saves single values as list, below it is reversed: ["value"] -> "value"
fileLines <- readLines(fileName)
replaceLines <- gsub(pattern = '\\["', replace = '"', x = fileLines)
replaceLines <- gsub(pattern = '"\\]', replace = '"', x = replaceLines)
replaceLines <- str_replace_all(replaceLines, "\\[([:digit:]*)\\]", "\\1")
replaceLines <- gsub(pattern = '\\[false\\]', replace = 'false', x = replaceLines)
replaceLines <- gsub(pattern = '\\[true\\]', replace = 'true', x = replaceLines)
writeLines(replaceLines, con=fileName)
}
}
}
library(stringr)
library(rjson)
numExtract <- function(string) {
allNumbers <- regmatches(string, gregexpr("[[:digit:]]+", string))
allNumbers <- as.numeric(unlist(allNumbers))
allNumbers <- as.list(strsplit(toString(allNumbers), ", ")[[1]])
return(allNumbers)
}
weeks <- list("01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20")
years <- list("2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017")
#Creating the Folders if not exists
path <- "..\\Data\\Output"
if (!(dir.exists(path))){
dir.create(path)
}
for (year in years) {
for (week in weeks) {
path <- paste(c("..\\Data\\Output\\", year), collapse = "")
if (!(dir.exists(path))){
dir.create(path)
}
}
}
for (year in years) {
for (week in weeks) {
weekFile <- paste(c("..\\Data\\RMoreInformation\\", year, "\\week_", week, ".json"), collapse = "") # File with the information of the week and the comments
if (file.exists(weekFile)) {
resultWeek <- rjson::fromJSON(file = weekFile)
i <- 1
for (game in resultWeek$games) {
numbers <- numExtract(game$comments)
j <- 1
if (game$players != "NoPlayersFound"){
for (player in game$players) {
playerInformation <- player$`game information`
properties <- paste(names(playerInformation), playerInformation)
for (number in numbers) {
for (property in properties) {
propertyName <- strsplit(property, "[[:space:]]")[[1]][1]
propertyValue <- strsplit(property, "[[:space:]]")[[1]][2]
if (number == propertyValue) {
if (number != 0) {
playerInformation[[propertyName]] <- list(propertyValue, 13)
names(playerInformation[[propertyName]]) <- c("propertyValue", "annotationID")
}
}
}
}
resultWeek$games[[i]]$players[[j]]$`game information` <- playerInformation
j <- j + 1
}
}
i <- i + 1
}
exportJSON <- rjson::toJSON(resultWeek, 1) #Generate JSON
fileName <- paste(c("..\\Data\\Output\\", year, "\\week_", week, ".json"), collapse = "")
write(exportJSON, fileName) #Save JSON to file
}
}
}
game
length(game$players)
weeks <- list("01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20")
years <- list("2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017")
#Creating the Folders if not exists
path <- "..\\Data\\Output"
if (!(dir.exists(path))){
dir.create(path)
}
for (year in years) {
for (week in weeks) {
path <- paste(c("..\\Data\\Output\\", year), collapse = "")
if (!(dir.exists(path))){
dir.create(path)
}
}
}
for (year in years) {
for (week in weeks) {
weekFile <- paste(c("..\\Data\\RMoreInformation\\", year, "\\week_", week, ".json"), collapse = "") # File with the information of the week and the comments
if (file.exists(weekFile)) {
resultWeek <- rjson::fromJSON(file = weekFile)
i <- 1
for (game in resultWeek$games) {
numbers <- numExtract(game$comments)
j <- 1
if (length(game$players) > 0){
for (player in game$players) {
playerInformation <- player$`game information`
properties <- paste(names(playerInformation), playerInformation)
for (number in numbers) {
for (property in properties) {
propertyName <- strsplit(property, "[[:space:]]")[[1]][1]
propertyValue <- strsplit(property, "[[:space:]]")[[1]][2]
if (number == propertyValue) {
if (number != 0) {
playerInformation[[propertyName]] <- list(propertyValue, 13)
names(playerInformation[[propertyName]]) <- c("propertyValue", "annotationID")
}
}
}
}
resultWeek$games[[i]]$players[[j]]$`game information` <- playerInformation
j <- j + 1
}
}
i <- i + 1
}
exportJSON <- rjson::toJSON(resultWeek, 1) #Generate JSON
fileName <- paste(c("..\\Data\\Output\\", year, "\\week_", week, ".json"), collapse = "")
write(exportJSON, fileName) #Save JSON to file
}
}
}
week
year
game
length(game$players)
for (year in years) {
for (week in weeks) {
weekFile <- paste(c("..\\Data\\RMoreInformation\\", year, "\\week_", week, ".json"), collapse = "") # File with the information of the week and the comments
if (file.exists(weekFile)) {
resultWeek <- rjson::fromJSON(file = weekFile)
i <- 1
for (game in resultWeek$games) {
numbers <- numExtract(game$comments)
j <- 1
if (length(game$players) > 1){
for (player in game$players) {
playerInformation <- player$`game information`
properties <- paste(names(playerInformation), playerInformation)
for (number in numbers) {
for (property in properties) {
propertyName <- strsplit(property, "[[:space:]]")[[1]][1]
propertyValue <- strsplit(property, "[[:space:]]")[[1]][2]
if (number == propertyValue) {
if (number != 0) {
playerInformation[[propertyName]] <- list(propertyValue, 13)
names(playerInformation[[propertyName]]) <- c("propertyValue", "annotationID")
}
}
}
}
resultWeek$games[[i]]$players[[j]]$`game information` <- playerInformation
j <- j + 1
}
}
i <- i + 1
}
exportJSON <- rjson::toJSON(resultWeek, 1) #Generate JSON
fileName <- paste(c("..\\Data\\Output\\", year, "\\week_", week, ".json"), collapse = "")
write(exportJSON, fileName) #Save JSON to file
}
}
}
library(stringr)
library(rjson)
# Function extracts all numbers from given text
numExtract <- function(string) {
allNumbers <- regmatches(string, gregexpr("[[:digit:]]+", string))
allNumbers <- as.numeric(unlist(allNumbers))
allNumbers <- as.list(strsplit(toString(allNumbers), ", ")[[1]])
return(allNumbers)
}
weeks <- list("01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20")
years <- list("2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015", "2016", "2017")
# Creating the Folders if not exists
path <- "..\\Data\\Output"
if (!(dir.exists(path))){
dir.create(path)
}
for (year in years) {
for (week in weeks) {
path <- paste(c("..\\Data\\Output\\", year), collapse = "")
if (!(dir.exists(path))){
dir.create(path)
}
}
}
id <- 1
for (year in years) {
for (week in weeks) {
weekFile <- paste(c("..\\Data\\RMoreInformation\\", year, "\\week_", week, ".json"), collapse = "") # File with the information of the game
if (file.exists(weekFile)) {
resultWeek <- rjson::fromJSON(file = weekFile)
i <- 1 # For iteration purpsoe
for (game in resultWeek$games) {
numbers <- numExtract(game$comments) # Get numbers from text
j <- 1
if (length(game$players) > 1){ # Games which doesn't have any players are filtered here
for (player in game$players) {
playerInformation <- player$`game information` # Get the detailed information of the player for this game
properties <- paste(names(playerInformation), playerInformation)
# Check for each number if it occurs in the statistics of the player
for (number in numbers) {
for (property in properties) {
propertyName <- strsplit(property, "[[:space:]]")[[1]][1]
propertyValue <- strsplit(property, "[[:space:]]")[[1]][2]
if (number == propertyValue) {
if (number != 0) {
playerInformation[[propertyName]] <- list(propertyValue, id)
names(playerInformation[[propertyName]]) <- c("propertyValue", "annotationID") # Add marker for annotation, if match is found
id <- id + 1
}
}
}
}
resultWeek$games[[i]]$players[[j]]$`game information` <- playerInformation
j <- j + 1
}
}
i <- i + 1
}
exportJSON <- rjson::toJSON(resultWeek, 1) # Generate JSON
fileName <- paste(c("..\\Data\\Output\\", year, "\\week_", week, ".json"), collapse = "")
write(exportJSON, fileName) # Save JSON to file
}
}
}
